<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>版本控制管理工具 Git | Light Line</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="This article shows the basic use of Git.">
    <meta name="generator" content="Hugo 0.109.0">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
    <meta property="og:title" content="版本控制管理工具 Git" />
<meta property="og:description" content="This article shows the basic use of Git." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lightline.top/posts/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7-git/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-01T21:57:40+08:00" />
<meta property="article:modified_time" content="2023-02-04T16:45:40+08:00" />
<meta itemprop="name" content="版本控制管理工具 Git">
<meta itemprop="description" content="This article shows the basic use of Git."><meta itemprop="datePublished" content="2022-08-01T21:57:40+08:00" />
<meta itemprop="dateModified" content="2023-02-04T16:45:40+08:00" />
<meta itemprop="wordCount" content="793">
<meta itemprop="keywords" content="web," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="版本控制管理工具 Git"/>
<meta name="twitter:description" content="This article shows the basic use of Git."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  <header class="cover bg-top" style="background-image: url('https://lightline.top/images/hero-image.jpg');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Light Line
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <div class="f2 f1-l fw2 white-90 mb0 lh-title">版本控制管理工具 Git</div>
          
            <div class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              This article shows the basic use of Git.
            </div>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">版本控制管理工具 Git</h1>
      
      <p class="tracked">
        By <strong>胡光线</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2022-08-01T21:57:40+08:00">August 1, 2022</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h1 id="版本控制管理工具-git">版本控制管理工具 Git</h1>
<h2 id="1-git配置权限---生成密钥---托管公钥---全局配置">1. Git配置：权限 -&gt; 生成密钥 -&gt; 托管公钥 -&gt; 全局配置</h2>
<h3 id="1-基本操作">1. 基本操作：</h3>
<h4 id="1-获取仓库权限">1. 获取仓库权限：</h4>
<h4 id="2-下载git">2. 下载Git；</h4>
<h4 id="3-电脑上生成ssh密钥打开终端执行-ssh-keyken--t-rsa--c-邮箱地址">3. 电脑上生成ssh密钥，打开终端，执行 ssh-keyken -t rsa -C &ldquo;邮箱地址&rdquo;</h4>
<h4 id="4-执行成功后切换至-ssh目录下-复制id_rsapub的内容">4. 执行成功后，切换至 ~/.ssh目录下， 复制id_rsa.pub的内容；</h4>
<h4 id="5-以github为例进入-settings---ssh-and-gpg-keys-通过cat命令查看id_rsapub的内容然后复制过来点击add-ssh-key相当于将公钥放到了github上托管">5. 以Github为例，进入 settings -&gt; SSH and GPG keys ，通过cat命令查看id_rsa.pub的内容，然后复制过来，点击add ssh key，相当于将公钥放到了Github上托管</h4>
<h4 id="6-全局配置">6. 全局配置：</h4>
<pre tabindex="0"><code>git config --global user.name &#34;xxx&#34;
git config --global user.email &#34;xxx@xx.com&#34;

git config --local user.name &#34;liuxiner&#34;
git config --local user.email &#34;1223495869@qq.com&#34;

git config --global user.name &#34;bella123987&#34;
git config --global user.email &#34;bella@vibe.us&#34;
</code></pre><p>验证github配置是否正确：</p>
<pre tabindex="0"><code>ssh -T git@github.com
</code></pre><blockquote>
<p>Note:</p>
<ul>
<li>采用ssh方式时，Git均会使用本地私钥和远程仓库公钥进行验证，流程更简单；</li>
<li>采用https方式，每次均需要手动输入用户名和密码。</li>
</ul>
</blockquote>
<h2 id="2-git-配置多个github账号">2. Git 配置多个github账号：</h2>
<h3 id="1-清空默认全局账户名和密码">1. 清空默认全局账户名和密码</h3>
<pre tabindex="0"><code>git config --global --unset user.name
git config --global --unset user.email
</code></pre><h3 id="2-为不同的-git-账户生成不同的-ssh-key">2. 为不同的 git 账户生成不同的 ssh-key</h3>
<p>id_ras 是默认的文件名称，我们现在需要生成不同的 ssh-key，所以要设置不同的文件存储对应的公钥，比如：自己的 GitHub 账户，使用 id_ras_github 命名；公司的账户，使用 id_ras_company 来命名</p>
<pre tabindex="0"><code>ssh-keygen -t rsa -C &#34;1223495869@qq.com&#34; -f id_rsa_github
ssh-keygen -t rsa -C &#34;bella@vibe.us&#34; -f id_rsa_company
</code></pre><h3 id="3-将-ssh-key-分别添加到-ssh-agent-信任列表">3. 将 ssh-key 分别添加到 ssh-agent 信任列表</h3>
<pre tabindex="0"><code>ssh-add ~/.ssh/id_rsa_github
ssh-add ~/.ssh/id_rsa_company
</code></pre><p>如果看到 Identitiy added: ~/.ssh/id_ras_github，就表示添加成功了。</p>
<h3 id="4-添加公钥到自己的-git-账户中">4. 添加公钥到自己的 git 账户中</h3>
<p>使用命令，copy公钥，到 git 账户中粘贴即可。</p>
<pre tabindex="0"><code>pbcopy &lt; ~/.ssh/id_rsa_github.pub
pbcopy &lt; ~/.ssh/id_rsa_company.pub
</code></pre><h3 id="5-在-config-文件配置多个-ssh-key">5. 在 config 文件配置多个 ssh-key</h3>
<p>在 .ssh/ 目录下，config文件（没有的话新建一个）</p>
<pre tabindex="0"><code># office account
Host github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_rsa_company

# personal account
Host personal.github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_rsa_github
</code></pre><h3 id="6-测试">6. 测试</h3>
<p>测试：ssh -T git@{config里面的user}.xxx主机名</p>
<pre tabindex="0"><code>ssh -T git@github.com
ssh -T git@personal.github.com
</code></pre><p>出现以下，则说明成功！</p>
<pre tabindex="0"><code>Hi user.name！ You&#39;ve successfully authenticated.but GITEE.COM 
does not provide shell acess
</code></pre><h3 id="7-使用不同的帐户克隆-github-存储库">7. 使用不同的帐户克隆 GitHub 存储库</h3>
<pre tabindex="0"><code>git clone git@github.com-{your-username}:{owner-user-name}/{the-repo-name}.git
 [multi-account] git clone git@personal.github.com:username/git-toy.git 
 [default] git clone git@github.com:username/git-toy.git
</code></pre><h3 id="8-配置本地git-config">8. 配置本地git config</h3>
<pre tabindex="0"><code>git config --list

git config --local user.name liuxiner
git config --local user.email 1223495869@qq.com

# 公司账号常用可配置为global
git config --global user.name company-name
git config --global user.email company-email
</code></pre><p>Refs :
<a href="https://juejin.cn/post/6999630383130083358">https://juejin.cn/post/6999630383130083358</a>
<a href="https://gist.github.com/rahularity/86da20fe3858e6b311de068201d279e3">https://gist.github.com/rahularity/86da20fe3858e6b311de068201d279e3</a></p>
<h1 id="2-git工作原理">2. Git工作原理</h1>
<h2 id="git工作区域和流程">Git工作区域和流程：</h2>
<p>Workspace: 工作区，平常开发改动的地方；
Index: 暂存区，工作区文件通过git add被移入暂存区；
Repository: 本地仓库，自己电脑；暂存区的内容通过git commit进入本地仓库；
Remote: 远程仓库，托管代码的服务器；本地仓库通过git push命令同步代码至远程仓库；</p>
<h1 id="3-git基本操作">3. Git基本操作</h1>
<h2 id="1-git-add-workspace---index">1. git add (workspace -&gt; index)</h2>
<pre tabindex="0"><code># 添加某个/多个文件至暂存区
git add ...filename
# 添加所有更改文件
git add .
</code></pre><h3 id="2-git-commit-index---repository">2. git commit (index -&gt; repository)</h3>
<pre tabindex="0"><code># 提交暂存的更改，会新开编辑器进行编辑
git commit 
# 提交暂存的更改，并记录下备注
git commit -m &#34;you message&#34;
# 等同于 git add . &amp;&amp; git commit -m 
# 仅支持未提交上线的commit
git commit -am &#34;you message&#34;
# 对最近一次的提交的信息进行修改,此操作会修改commit的hash值
git commit --amend
</code></pre><h3 id="3-git-pull--remote---workspace">3. git pull  (remote -&gt; workspace)</h3>
<pre tabindex="0"><code>等同于git fetch / git merge
# 从远程仓库拉取代码，合并至本地
git pull &lt;remote-hostname&gt; &lt;branch-name&gt;:&lt;workspace-name&gt;
# 通过rebase模式合并
git pull --rebase &lt;remote-hostname&gt; &lt;branch-name&gt;:&lt;workspace-name&gt;
</code></pre><h3 id="4-git-fetch-remote---repository">4. git fetch (remote -&gt; repository)</h3>
<pre tabindex="0"><code>拉取远程代码，自动进行merge操作
# 获取远程仓库特定分支的更新
git fetch &lt;remote-hostname&gt; &lt;branch-name&gt;
# 获取远程仓库所有分支的更新
git fetch -all
</code></pre><h3 id="5-git-branch">5. git branch</h3>
<pre tabindex="0"><code># 新建本地分支，但不切换
git branch &lt;branch-name&gt;
# 查看本地分支 
git branch
# 查看远程分支
git branch -r
# 查看本地和远程分支
git branch -a
# 删除本地分支
git branch -D &lt;branch-nane&gt;
# 重新命名分支
git branch -m &lt;old-branch-name&gt; &lt;new-branch-name&gt;
</code></pre><h3 id="6-git-status">6. git status</h3>
<p>查看当前状态</p>
<h1 id="4-git常见命令">4. Git常见命令</h1>
<h2 id="1-git-rebase">1. git rebase</h2>
<pre tabindex="0"><code># 与merge相似，将一个分支的修改合并到当前的分支上

# 产生冲突，需手动解决
git add
git rebase --continue

# 若不满意rebase结果，跳过rebase操作
git rebase --skip


# 若不再继续rebase，结束rebase操作
git rebase --abort
</code></pre><h2 id="交互模式">交互模式：</h2>
<p>此时会进入vim交互模式，此时合并需要使用squash策略进行合并，(squash策略：把当前的commit和上一个commit进行合并)；</p>
<pre tabindex="0"><code># base-commit: 指明基点提交对象，基于该基点进行rebase操作
git rebase -i &lt;base-commit&gt;
</code></pre><p>修改文件后，按下: ，然后wq保存退出，进入编辑页面；
修改为 feat: 更正，然后保存；
通过git branch查看commit信息。
Note: 只能在自己使用的分支上进行rebase操作，不能在集成分支进行rebase，否则会修改集成分支的历史记录。</p>
<h2 id="2-git-merge">2. git merge</h2>
<pre tabindex="0"><code># 与git rebase区别：非fast-forward的情况下，会产生一条额外的合并记录
Merge branch &#39;xxx&#39; into &#39;xxx&#39;
</code></pre><h2 id="3-git-cherry-pick">3. git cherry-pick</h2>
<pre tabindex="0"><code># &#34;挑拣&#34;提交，与merge不同，将指定的提交（commit）应用于当前分支
git cherry-pick &lt;commit-hash&gt; 
</code></pre><h2 id="4-git-checkout">4. git checkout</h2>
<pre tabindex="0"><code>git checkout -- &lt;filename&gt; 的命令，如果要撤回多个文件的修改，文件之间使用空格隔开，如下图所示，我们撤回了 1.js 文件的修改，工作区也恢复干净了。
</code></pre><h2 id="5-git-revert">5. git revert</h2>
<pre tabindex="0"><code>git revert &lt;commit-id&gt; 针对普通 commit
git revert &lt;commit-id&gt; -m 针对 merge 的 commit
</code></pre><p>新增了一条 commit 记录，这个 commit 的产生的 msg 是自动生成的，Revert 开头，后面跟撤回的 commit-msg 信息 之前的 commit 记录并没有消失，此时也达到了代码回退的效果</p>
<pre tabindex="0"><code>git revert [commit-id1] [commit-id2] ... 
</code></pre><p>注意这是一个前开后闭区间，即不包括 commit1 ，但包括 commit2 。</p>
<h2 id="6-git-stash">6. git stash</h2>
<pre tabindex="0"><code>git stash //把本地的改动暂存起来
git stash save &#34;message&#34; 执行存储时，添加备注，方便查找。
git stash pop // 应用最近一次暂存的修改，并删除暂存的记录
git stash apply  // 应用某个存储,但不会把存储从存储列表中删除，默认使用第一个存储,即 stash@{0}，如果要使用其他个，git stash apply stash@{$num} 。
git stash list // 查看 stash 有哪些存储
git stash clear // 删除所有缓存的 stash
</code></pre><h2 id="7-git-alias">7. git alias</h2>
<pre tabindex="0"><code>git config --global alias.co checkout //简化 git checkout
git config --global alias.ci commit //简化 git commit
git config --global alias.br branch //简化 git branch
</code></pre><p>也可以更新全局的 .gitconfig 文件，该文件用来保存全局的 git 配置，vim ~/.gitconfig</p>
<pre tabindex="0"><code>[alias]
st = status -sb
co = checkout
br = branch
mg = merge
ci = commit
ds = diff --staged
dt = difftool
mt = mergetool
last = log -1 HEAD
latest = for-each-ref --sort=-committerdate --format=\&#34;%(committername)@%(refname:short) [%(committerdate:short)] %(contents)\&#34;
ls = log --pretty=format:\&#34;%C(yellow)%h %C(blue)%ad %C(red)%d %C(reset)%s %C(green)[%cn]\&#34; --decorate --date=short
hist = log --pretty=format:\&#34;%C(yellow)%h %C(red)%d %C(reset)%s %C(green)[%an] %C(blue)%ad\&#34; --topo-order --graph --date=short
type = cat-file -t
dump = cat-file -p
lg = log --color --graph --pretty=format:&#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&#39; --abbrev-commit
</code></pre><h1 id="5-撤销于回滚">5. 撤销于回滚</h1>
<h2 id="撤销">撤销</h2>
<p>上述场景一，在未进行git push前的所有操作，都是在“本地仓库”中执行的。我们暂且将“本地仓库”的代码还原操作叫做“撤销”！</p>
<h3 id="情况一文件被修改了但未执行git-add操作working-tree内撤销">情况一：文件被修改了，但未执行git add操作（working tree内撤销）</h3>
<pre tabindex="0"><code>git checkout fileName
git checkout .
</code></pre><h3 id="情况二同时对多个文件执行了git-add操作但本次只想提交其中一部分文件">情况二：同时对多个文件执行了git add操作，但本次只想提交其中一部分文件</h3>
<pre tabindex="0"><code>git add *
git status
git reset HEAD &lt;filename&gt;
</code></pre><h3 id="情况三文件执行了git-add操作但想撤销对其的修改index内回滚">情况三：文件执行了git add操作，但想撤销对其的修改（index内回滚）</h3>
<pre tabindex="0"><code>git reset HEAD fileName
git checkout fileName
</code></pre><h3 id="情况四修改的文件已被git-commit但想再次修改不再产生新的commit">情况四：修改的文件已被git commit，但想再次修改不再产生新的Commit</h3>
<pre tabindex="0"><code>git add sample.txt
git commit --amend -m&#34;说明&#34;
</code></pre><h3 id="情况五已在本地进行了多次git-commit操作现在想撤销到其中某次commit">情况五：已在本地进行了多次git commit操作，现在想撤销到其中某次Commit</h3>
<pre tabindex="0"><code>git reset [--hard|soft|mixed|merge|keep] [commit|HEAD]
</code></pre><h2 id="回滚">回滚</h2>
<p>上述场景二，已进行git push，即已推送到“远程仓库”中。我们将已被提交到“远程仓库”的代码还原操作叫做“回滚”！注意：对远程仓库做回滚操作是有风险的，需提前做好备份和通知其他团队成员！</p>
<p>如果你每次更新线上，都会打tag，那恭喜你，你可以很快的处理上述场景二的情况</p>
<pre tabindex="0"><code>git checkout &lt;tag&gt;
</code></pre><p>如果你回到当前HEAD指向</p>
<pre tabindex="0"><code>git checkout &lt;branch_name&gt;
</code></pre><h3 id="情况一撤销指定文件到指定版本">情况一：撤销指定文件到指定版本</h3>
<pre tabindex="0"><code>git log &lt;filename&gt;
git checkout &lt;commitID&gt; &lt;filename&gt;
</code></pre><h3 id="情况二删除最后一次远程提交">情况二：删除最后一次远程提交</h3>
<h4 id="方式一使用revert">方式一：使用revert</h4>
<pre tabindex="0"><code>git revert HEAD
git push origin master
</code></pre><h4 id="方式二使用reset">方式二：使用reset</h4>
<pre tabindex="0"><code>git reset --hard HEAD^
git push origin master -f
</code></pre><p>二者区别：</p>
<ul>
<li>revert 是放弃指定提交的修改，但是会生成一次新的提交，需要填写提交注释，以前的历史记录都在；</li>
<li>reset 是指将HEAD指针指到指定提交，历史记录中不会出现放弃的提交记录。</li>
</ul>
<h3 id="情况三回滚某次提交">情况三：回滚某次提交</h3>
<pre tabindex="0"><code>git log
git revert commitID
</code></pre><p>删除某次提交</p>
<pre tabindex="0"><code>git log --oneline -n5
git rebase -i &#34;commit id&#34;^
</code></pre><p>注意： 需要注意最后的^号，意思是commit id的前一次提交</p>
<pre tabindex="0"><code> git rebase -i &#34;5b3ba7a&#34;^
</code></pre><p>在编辑框中删除相关commit，如pick 5b3ba7a test2，然后保存退出（如果遇到冲突需要先解决冲突）！</p>
<pre tabindex="0"><code> git push origin master -f
</code></pre><p>通过上述操作，如果你想对历史多个commit进行处理或者，可以选择git rebase -i，只需删除对应的记录就好。rebase还可对 commit 消息进行编辑，以及合并多个commit。</p>
<p>##Refs：
<a href="https://juejin.cn/post/6974184935804534815#heading-12">https://juejin.cn/post/6974184935804534815#heading-12</a>
<a href="https://juejin.cn/post/6999630383130083358">https://juejin.cn/post/6999630383130083358</a>
<a href="https://gist.github.com/rahularity/86da20fe3858e6b311de068201d279e3">https://gist.github.com/rahularity/86da20fe3858e6b311de068201d279e3</a>
<a href="https://blog.csdn.net/ligang2585116/article/details/71094887">https://blog.csdn.net/ligang2585116/article/details/71094887</a></p>
<ul class="pa0">
  
   <li class="list di">
     <a href="/tags/web/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">web</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://lightline.top/" >
    &copy;  Light Line 2023 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
